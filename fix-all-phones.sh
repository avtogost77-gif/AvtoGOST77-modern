#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö

echo "üìû –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –¢–ï–õ–ï–§–û–ù–û–í –í–û –í–°–ï–• –§–ê–ô–õ–ê–•..."

# –ú–∞—Å—Å–∏–≤ HTML —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∏—Å–∫–ª—é—á–∞–µ–º backup –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
html_files=($(find . -maxdepth 1 -name "*.html" -not -path "./backup*" -not -path "./mega-cleanup-backup*" -not -path "./inline-styles-backup*" -not -path "./canonical-fix-backup*" -not -path "./schema-fix-backup*" -not -path "./seo-fix-backup*" -not -path "./blog-fix-backup*" -not -path "./mobile-cleanup-backup*"))

echo ""
echo "üìÑ –ù–∞–π–¥–µ–Ω–æ HTML —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: ${#html_files[@]}"

echo ""
echo "üìû –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω—ã..."

# –°—á–µ—Ç—á–∏–∫–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
fixed_count=0

for file in "${html_files[@]}"; do
    echo "   üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º: $file"
    
    # –ó–∞–º–µ–Ω—è–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
    # 7999458907 -> +79162720932
    sed -i 's/7999458907/+79162720932/g' "$file"
    
    # +7 (495) 268-06-8X -> +7 916 272-09-32
    sed -i 's/+7 (495) 268-06-8[0-9]/+7 916 272-09-32/g' "$file"
    
    # +7 495 268-06-8X -> +7 916 272-09-32
    sed -i 's/+7 495 268-06-8[0-9]/+7 916 272-09-32/g' "$file"
    
    # 495 268-06-8X -> +7 916 272-09-32
    sed -i 's/495 268-06-8[0-9]/+7 916 272-09-32/g' "$file"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –µ—â–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã
    if grep -q "268-06-8" "$file"; then
        echo "   ‚ö†Ô∏è  –ù–∞–π–¥–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã –≤: $file"
        fixed_count=$((fixed_count + 1))
    fi
done

echo ""
echo "‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö!"
echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:"
echo "   - –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${#html_files[@]}"
echo "   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤: $fixed_count"
echo "   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω: +7 916 272-09-32"
echo ""
echo "ÔøΩÔøΩ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!"
