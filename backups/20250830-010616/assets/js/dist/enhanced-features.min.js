class UXImprovements{constructor(){this.init()}init(){this.setupAccordions(),this.setupStickyTOC(),this.setupTLDR(),this.setupLazyLoading(),this.setupScrollAnimations(),this.setupCalculatorEnhancements(),this.setupMobileStickyActions()}setupAccordions(){let s=document.querySelectorAll(".accordion");s.forEach(t=>{var e=t.querySelector(".accordion-trigger");let n=t.querySelector(".accordion-content");e&&n&&e.addEventListener("click",()=>{var e=t.classList.contains("open");s.forEach(e=>{e!==t&&(e.classList.remove("open"),e=e.querySelector(".accordion-content"))&&(e.style.maxHeight="0px")}),e?(t.classList.remove("open"),n.style.maxHeight="0px"):(t.classList.add("open"),n.style.maxHeight=n.scrollHeight+"px")})})}setupCalculatorEnhancements(){var e=document.getElementById("downloadPdf");e&&e.addEventListener("click",()=>{window.calculatorV2&&"function"==typeof window.calculatorV2.downloadPDF?window.calculatorV2.downloadPDF():window.pdfLeadMagnet&&window.pdfLeadMagnet.showContactModal()})}setupMobileStickyActions(){var e;window.matchMedia("(max-width: 768px)").matches&&!document.querySelector(".mobile-sticky-actions")&&((e=document.createElement("div")).className="mobile-sticky-actions",e.innerHTML=`
        <a href="tel:+79162720932" class="msa-item">üìû –ó–≤–æ–Ω–æ–∫</a>
        <a href="https://wa.me/79162720932" target="_blank" class="msa-item">üí¨ WhatsApp</a>
        <a href="#calculator" class="msa-item">üßÆ –†–∞—Å—á–µ—Ç</a>
      `,document.body.appendChild(e))}setupStickyTOC(){let n=document.querySelector(".sticky-toc");if(n){var s=document.querySelectorAll("h2, h3");let a=n.querySelector(".toc-list");if(a){s.forEach((t,e)=>{var e=t.id||"heading-"+e,n=(t.id=e,document.createElement("li")),s=(n.className="toc-item toc-"+t.tagName.toLowerCase(),document.createElement("a"));s.href="#"+e,s.textContent=t.textContent,s.addEventListener("click",e=>{e.preventDefault(),t.scrollIntoView({behavior:"smooth"})}),n.appendChild(s),a.appendChild(n)});let e=!1,t=n.offsetTop;window.addEventListener("scroll",()=>{window.pageYOffset>t&&!e?(n.classList.add("sticky"),e=!0):window.pageYOffset<=t&&e&&(n.classList.remove("sticky"),e=!1)})}}}setupTLDR(){let t=document.querySelector(".tldr");if(t){var n=t.querySelector(".tldr-content");let e=t.querySelector(".tldr-toggle");n&&e&&e.addEventListener("click",()=>{t.classList.contains("expanded")?(t.classList.remove("expanded"),e.textContent="–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏"):(t.classList.add("expanded"),e.textContent="–°–∫—Ä—ã—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏")})}}setupLazyLoading(){var e=document.querySelectorAll("img[data-src]");let t=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&((e=e.target).src=e.dataset.src,e.classList.remove("lazy"),e.classList.add("loaded"),t.unobserve(e))})});e.forEach(e=>{e.classList.add("lazy"),t.observe(e)})}setupScrollAnimations(){var e=document.querySelectorAll(".animate-on-scroll");let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("visible")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});e.forEach(e=>{t.observe(e)})}createAccordion(e,t,n=!1){var s=document.createElement("div");return s.className="accordion "+(n?"open":""),s.innerHTML=`
      <div class="accordion-trigger">
        <span class="accordion-title">${e}</span>
        <span class="accordion-icon">${n?"‚àí":"+"}</span>
      </div>
      <div class="accordion-content" style="max-height: ${n?"none":"0px"}">
        <div class="accordion-body">
          ${t}
        </div>
      </div>
    `,s}createTLDR(e,t){var n=document.createElement("div");return n.className="tldr",n.innerHTML=`
      <div class="tldr-header">
        <h3>üìã –ö—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</h3>
        <button class="tldr-toggle">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏</button>
      </div>
      <div class="tldr-content">
        <div class="tldr-summary">
          ${e}
        </div>
        <div class="tldr-details">
          ${t}
        </div>
      </div>
    `,n}createStickyTOC(){var e=document.createElement("div");return e.className="sticky-toc",e.innerHTML=`
      <div class="toc-header">
        <h3>üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</h3>
      </div>
      <ul class="toc-list"></ul>
    `,e}createBenefitCard(e,t,n){var s=document.createElement("div");return s.className="benefit-card animate-on-scroll",s.innerHTML=`
      <div class="benefit-icon">${e}</div>
      <h4 class="benefit-title">${t}</h4>
      <p class="benefit-description">${n}</p>
    `,s}createMiniCase(e,t,n){var s=document.createElement("div");return s.className="mini-case animate-on-scroll",s.innerHTML=`
      <div class="case-header">
        <h4>${e}</h4>
      </div>
      <div class="case-stats">
        ${t.map(e=>`<div class="case-stat"><span class="stat-value">${e.value}</span><span class="stat-label">${e.label}</span></div>`).join("")}
      </div>
      <p class="case-description">${n}</p>
    `,s}}document.addEventListener("DOMContentLoaded",()=>{window.uxImprovements=new UXImprovements});class TLDRComponent{constructor(){this.init()}init(){window.toggleDetails=e=>{var t=e.closest(".tldr-block").nextElementSibling;t&&t.classList.contains("tldr-content")?"none"!==t.style.display&&t.style.display?(t.style.display="none",e.textContent="–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏"):(t.style.display="block",e.textContent="–°–∫—Ä—ã—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏"):console.error("–ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è TL;DR –Ω–µ –Ω–∞–π–¥–µ–Ω")}}}class StickyTOC{constructor(){this.toc=null,this.init()}init(){this.toc=document.querySelector(".sticky-toc"),this.toc&&(this.generateTOC(),this.setupSticky(),this.trackActiveSection())}generateTOC(){let s=this.toc.querySelector(".toc-list");s&&document.querySelectorAll("h2:not(.no-toc), h3:not(.no-toc)").forEach((t,e)=>{t.id||(t.id="section-"+e);var e=document.createElement("li"),n=document.createElement("a");n.href="#"+t.id,n.textContent=t.textContent,n.className="H2"===t.tagName?"toc-h2":"toc-h3",n.addEventListener("click",e=>{e.preventDefault(),t.scrollIntoView({behavior:"smooth",block:"start"})}),e.appendChild(n),s.appendChild(e)})}setupSticky(){let t;window.addEventListener("scroll",()=>{var e=window.pageYOffset||document.documentElement.scrollTop;200<e?this.toc.classList.add("sticky"):this.toc.classList.remove("sticky"),t=e})}trackActiveSection(){let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(document.querySelectorAll(".toc-list a").forEach(e=>{e.classList.remove("active")}),e=document.querySelector(`.toc-list a[href="#${e.target.id}"]`))&&e.classList.add("active")})},{rootMargin:"-20% 0px -70% 0px"});document.querySelectorAll("h2[id], h3[id]").forEach(e=>{t.observe(e)})}}function initCalculatorUI(){let e=document.getElementById("calculatorForm"),s=document.getElementById("calculatorResult"),a=document.getElementById("calculateButton");var t=document.getElementById("newCalculation");e&&s&&a&&(a.addEventListener("click",function(e){e.preventDefault();var e=document.getElementById("fromCity"),t=document.getElementById("toCity"),n=document.getElementById("weight");e.value&&t.value&&n.value?(a.disabled=!0,a.innerHTML='<span class="loading-spinner"></span> –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º...',setTimeout(function(){("function"==typeof calculateDelivery?calculateDelivery:showDummyResult)(),a.disabled=!1,a.textContent="–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å",updateProgressBar(2),s.style.display="block",document.getElementById("step1").style.display="none",document.getElementById("step3").style.display="none"},800)):(e.value||e.classList.add("invalid"),t.value||t.classList.add("invalid"),n.value||n.classList.add("invalid"))}),t)&&t.addEventListener("click",function(){e.reset(),s.style.display="none",document.getElementById("step1").style.display="block",updateProgressBar(1)})}function setupInputHandlers(){document.querySelectorAll(".form-control").forEach(function(e){e.addEventListener("focus",function(){this.classList.remove("invalid")})});let e=document.getElementById("fromCity");e&&setTimeout(function(){e.focus()},500),addInputIcons()}function addInputIcons(){var e,t=document.getElementById("fromCity"),t=(t&&t.parentNode.classList.contains("input-with-icon")&&((e=document.createElement("span")).className="input-icon",e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z"/></svg>',t.parentNode.appendChild(e)),document.getElementById("toCity"));t&&t.parentNode.classList.contains("input-with-icon")&&((e=document.createElement("span")).className="input-icon",e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z"/></svg>',t.parentNode.appendChild(e))}function updateProgressBar(n){var e=document.querySelectorAll(".progress-step"),t=document.getElementById("progressFill");e.length&&t&&(e.forEach(function(e){var t=parseInt(e.getAttribute("data-step"));t===n?e.classList.add("active"):e.classList.remove("active"),t<n?e.classList.add("completed"):e.classList.remove("completed")}),e=(n-1)/(e.length-1)*100,t.style.width=e+"%")}function setupLiveCalculation(){let n=document.getElementById("fromCity"),s=document.getElementById("toCity"),a=document.getElementById("weight");var i=document.getElementById("volume"),l=document.getElementById("isConsolidated");if(n&&s&&a&&i&&l){let e,t=function(){if(n.value&&s.value&&a.value){let e=document.getElementById("calculateButton");e&&(e.innerHTML="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç..."),setTimeout(function(){e&&(e.innerHTML="–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å (~5000-8000 ‚ÇΩ)")},500)}};var c=function(){clearTimeout(e),e=setTimeout(t,1e3)};n.addEventListener("input",c),s.addEventListener("input",c),a.addEventListener("input",c),i.addEventListener("input",c),l.addEventListener("change",c)}}function showDummyResult(){var e=document.getElementById("resultPrice"),t=document.getElementById("resultDetails");e&&t&&(e.textContent="7,500 ‚ÇΩ",t.innerHTML=`
        <div class="result-detail-item">
            <div class="result-detail-label">–ú–∞—Ä—à—Ä—É—Ç</div>
            <div class="result-detail-value">${document.getElementById("fromCity").value} ‚Üí ${document.getElementById("toCity").value}</div>
        </div>
        <div class="result-detail-item">
            <div class="result-detail-label">–í–µ—Å –≥—Ä—É–∑–∞</div>
            <div class="result-detail-value">${document.getElementById("weight").value} –∫–≥</div>
        </div>
        <div class="result-detail-item">
            <div class="result-detail-label">–û–±—ä–µ–º</div>
            <div class="result-detail-value">${document.getElementById("volume").value||"0"} –º¬≥</div>
        </div>
        <div class="result-detail-item">
            <div class="result-detail-label">–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏</div>
            <div class="result-detail-value">${document.getElementById("isConsolidated").checked?"–°–±–æ—Ä–Ω—ã–π –≥—Ä—É–∑":"–û—Ç–¥–µ–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞"}</div>
        </div>
        <div class="result-detail-item">
            <div class="result-detail-label">–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏</div>
            <div class="result-detail-value">1-2 –¥–Ω—è</div>
        </div>
    `)}document.addEventListener("DOMContentLoaded",()=>{new TLDRComponent,new StickyTOC}),document.addEventListener("DOMContentLoaded",function(){initCalculatorUI(),setupInputHandlers(),setupLiveCalculation()});