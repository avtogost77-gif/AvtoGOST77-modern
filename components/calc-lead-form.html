<!-- üìû –§–û–†–ú–ê –ó–ê–•–í–ê–¢–ê –ü–û–°–õ–ï –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê -->
<!-- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ -->

<div class="calc-lead-form" id="calcLeadForm" style="display: none;">
    <h3>–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞</h3>
    <p>–û—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∏ –º—ã –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–º —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç —Å —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π</p>
    
    <form id="leadForm" onsubmit="submitLeadForm(event)">
        <input type="text" 
               name="name" 
               placeholder="–í–∞—à–µ –∏–º—è" 
               required>
        
        <input type="tel" 
               name="phone" 
               placeholder="+7 (___) ___-__-__" 
               pattern="\+7\s?\(?\d{3}\)?\s?\d{3}[\s-]?\d{2}[\s-]?\d{2}" 
               required>
        
        <input type="hidden" name="route" id="routeInput">
        <input type="hidden" name="price" id="priceInput">
        
        <button type="submit">
            <i class="fas fa-phone-alt"></i> –ü–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç
        </button>
    </form>
    
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ú—ã –æ–Ω–ª–∞–π–Ω" -->
    <div class="online-indicator" style="margin-top: 15px;">
        <span class="online-dot"></span>
        <span>–ú–µ–Ω–µ–¥–∂–µ—Ä—ã –æ–Ω–ª–∞–π–Ω</span>
    </div>
</div>

<!-- –ë–ª–æ–∫ –¥–æ–≤–µ—Ä–∏—è -->
<div class="trust-badges">
    <div class="trust-badge">
        <i class="fas fa-truck"></i>
        <h4>1500+</h4>
        <p>–¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –º–µ—Å—è—Ü</p>
    </div>
    <div class="trust-badge">
        <i class="fas fa-clock"></i>
        <h4>24/7</h4>
        <p>—Ä–∞–±–æ—Ç–∞–µ–º –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ</p>
    </div>
    <div class="trust-badge">
        <i class="fas fa-shield-alt"></i>
        <h4>100%</h4>
        <p>—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞</p>
    </div>
    <div class="trust-badge">
        <i class="fas fa-ruble-sign"></i>
        <h4>2500‚ÇΩ</h4>
        <p>–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞</p>
    </div>
</div>

<script>
// –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞
function showLeadForm(route, price) {
    const form = document.getElementById('calcLeadForm');
    const routeInput = document.getElementById('routeInput');
    const priceInput = document.getElementById('priceInput');
    
    if (form && routeInput && priceInput) {
        routeInput.value = route;
        priceInput.value = price;
        form.style.display = 'block';
        
        // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ñ–æ—Ä–º–µ
        form.scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        // –¶–µ–ª—å –≤ –ú–µ—Ç—Ä–∏–∫–µ
        if (typeof ym !== 'undefined') {
            ym(103413788, 'reachGoal', 'lead_form_shown');
        }
    }
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
function submitLeadForm(event) {
    event.preventDefault();
    
    const formData = new FormData(event.target);
    const data = Object.fromEntries(formData);
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram –±–æ—Ç–∞
    fetch('/api/lead', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
        event.target.innerHTML = `
            <div style="padding: 40px; text-align: center;">
                <i class="fas fa-check-circle" style="font-size: 60px; color: #4CAF50; margin-bottom: 20px;"></i>
                <h3>–°–ø–∞—Å–∏–±–æ! –ú—ã —É–∂–µ –∑–≤–æ–Ω–∏–º –≤–∞–º!</h3>
                <p>–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç</p>
            </div>
        `;
        
        // –¶–µ–ª—å –≤ –ú–µ—Ç—Ä–∏–∫–µ
        if (typeof ym !== 'undefined') {
            ym(103413788, 'reachGoal', 'lead_form_sent', data);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º: +7 (999) 999-99-99');
    });
}

// –ú–∞—Å–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
document.addEventListener('DOMContentLoaded', function() {
    const phoneInput = document.querySelector('input[name="phone"]');
    if (phoneInput) {
        phoneInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.startsWith('7')) value = value.substring(1);
            if (value.startsWith('8')) value = value.substring(1);
            
            let formatted = '+7';
            if (value.length > 0) formatted += ' (' + value.substring(0, 3);
            if (value.length > 3) formatted += ') ' + value.substring(3, 6);
            if (value.length > 6) formatted += '-' + value.substring(6, 8);
            if (value.length > 8) formatted += '-' + value.substring(8, 10);
            
            e.target.value = formatted;
        });
    }
});
</script>