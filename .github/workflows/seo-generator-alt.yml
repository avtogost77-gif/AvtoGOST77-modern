name: SEO Pages Generator (Alternative)

on:
  workflow_dispatch:
    inputs:
      pages_count:
        description: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏'
        required: false
        default: '50'
      strategy:
        description: '–°—Ç—Ä–∞—Ç–µ–≥–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏'
        required: false
        default: 'routes-extended'
        type: choice
        options:
        - routes
        - routes-extended
        - industries
        - calculators

jobs:
  generate-pages:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'

    - name: Install dependencies
      run: |
        npm install fs-extra axios --no-package-lock --no-save

    - name: Generate Pages
      run: |
        PAGES_COUNT="${{ github.event.inputs.pages_count || '50' }}"
        STRATEGY="${{ github.event.inputs.strategy || 'routes-extended' }}"
        
        echo "üöÄ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º $PAGES_COUNT —Å—Ç—Ä–∞–Ω–∏—Ü ($STRATEGY)"
        
        case $STRATEGY in
          "routes-extended")
            node .github/scripts/generate-routes-extended.js
            ;;
          "routes")
            node .github/scripts/generate-routes.js
            ;;
          "calculators")
            node .github/scripts/generate-calculators.js
            ;;
          "industries")
            node .github/scripts/generate-industries.js
            ;;
        esac

    - name: Update Sitemap
      run: |
        if [ -f ".github/scripts/update-sitemap.js" ]; then
          node .github/scripts/update-sitemap.js
        else
          echo "‚ö†Ô∏è update-sitemap.js –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º"
        fi

    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v5
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: |
          ü§ñ AUTO-SEO: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ${{ github.event.inputs.pages_count || '50' }} —Å—Ç—Ä–∞–Ω–∏—Ü (${{ github.event.inputs.strategy || 'routes-extended' }})
          
          ‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏—è: ${{ github.event.inputs.strategy || 'routes-extended' }}
          üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${{ github.event.inputs.pages_count || '50' }} —Å—Ç—Ä–∞–Ω–∏—Ü
          üó∫Ô∏è Sitemap –æ–±–Ω–æ–≤–ª–µ–Ω
        title: 'ü§ñ –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è SEO —Å—Ç—Ä–∞–Ω–∏—Ü'
        body: |
          ## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SEO —Å—Ç—Ä–∞–Ω–∏—Ü—ã
          
          **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
          - üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${{ github.event.inputs.pages_count || '50' }} —Å—Ç—Ä–∞–Ω–∏—Ü
          - üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—è: ${{ github.event.inputs.strategy || 'routes-extended' }}
          - üïê –í—Ä–µ–º—è: $(date '+%Y-%m-%d %H:%M:%S')
          
          **–ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ:**
          - ‚úÖ –ù–æ–≤—ã–µ SEO-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
          - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π sitemap.xml
          - ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
          
          –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –º–µ—Ä–∂–∏—Ç–µ PR –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü.
        branch: auto-seo-${{ github.run_number }}
        delete-branch: true

    - name: Summary
      run: |
        echo "‚úÖ –ì–ï–ù–ï–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!"
        echo "üìä –°–æ–∑–¥–∞–Ω Pull Request —Å –Ω–æ–≤—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏"
        echo "üîó –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É Pull Requests –¥–ª—è –º–µ—Ä–∂–∞"