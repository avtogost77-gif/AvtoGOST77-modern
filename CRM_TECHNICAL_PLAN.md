# üöõ –ê–í–¢–û–ì–û–°–¢77 CRM - –ü–û–õ–ù–´–ô –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –ü–õ–ê–ù

**–ü—Ä–æ–µ–∫—Ç:** CRM —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –ê–≤—Ç–æ–ì–û–°–¢77  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 31 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–°—Ç–∞—Ç—É—Å:** –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ  

## üìã **–û–ë–©–ò–ô –û–ë–ó–û–† –ü–†–û–ï–ö–¢–ê**

### **–¶–µ–ª—å:**
–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é CRM —Å–∏—Å—Ç–µ–º—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–µ–º–Ω—ã–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π –≤—Å–µ—Ö –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

### **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- ‚úÖ –ï–¥–∏–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è (HTML + SCSS + Vanilla JS)
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤
- ‚úÖ –ó–µ—Ä–∫–∞–ª—å–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã
- ‚úÖ –ü–æ–ª–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç

---

## üèóÔ∏è **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´**

### **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:**
```
Frontend:     HTML5 + SCSS + Vanilla JavaScript
Backend:      Python 3.11 + FastAPI + PostgreSQL
Deployment:   Docker + Docker Compose
Database:     PostgreSQL 15
File Storage: Local filesystem
PDF Generation: jsPDF / Server-side
```

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**
```
avtogost77-crm/
‚îú‚îÄ‚îÄ pages/                     # HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html         # –ì–ª–∞–≤–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ leads/                # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ partners/             # –†–µ–µ—Å—Ç—Ä –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ management/           # –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ documents/            # –î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ contracts/            # –ó–µ—Ä–∫–∞–ª—å–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ analytics/            # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îú‚îÄ‚îÄ styles/                   # SCSS —Å—Ç–∏–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ _settings/            # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ _components/          # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ main.scss
‚îú‚îÄ‚îÄ scripts/                  # JavaScript
‚îÇ   ‚îú‚îÄ‚îÄ api/                  # API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ components/           # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ pages/               # –õ–æ–≥–∏–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
‚îú‚îÄ‚îÄ backend/                  # Python FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/          # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/             # API endpoints
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ shared/                   # –û–±—â–∏–µ —Ä–µ—Å—É—Ä—Å—ã
    ‚îú‚îÄ‚îÄ styles/              # –û–±—â–∏–µ —Å—Ç–∏–ª–∏
    ‚îî‚îÄ‚îÄ scripts/             # –û–±—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã
```

---

## üóÑÔ∏è **–°–¢–†–£–ö–¢–£–†–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•**

### **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**

```sql
-- –ó–∞—è–≤–∫–∏
CREATE TABLE leads (
    id SERIAL PRIMARY KEY,
    client_name VARCHAR(200) NOT NULL,
    client_phone VARCHAR(20) NOT NULL,
    client_email VARCHAR(100),
    route_from VARCHAR(100) NOT NULL,
    route_to VARCHAR(100) NOT NULL,
    cargo_name VARCHAR(200),
    cargo_weight DECIMAL(10,2),
    cargo_volume DECIMAL(10,2),
    cargo_packaging VARCHAR(100),
    loading_date DATE,
    loading_time_from TIME,
    loading_time_to TIME,
    unloading_date DATE,
    unloading_time TIME,
    loading_address TEXT,
    unloading_address TEXT,
    status VARCHAR(50) DEFAULT 'new',
    source VARCHAR(50) DEFAULT 'website',
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- –ü–∞—Ä—Ç–Ω–µ—Ä—ã-–ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∏
CREATE TABLE partners (
    id SERIAL PRIMARY KEY,
    company_name VARCHAR(200) NOT NULL,
    inn VARCHAR(12),
    kpp VARCHAR(9),
    legal_address TEXT,
    actual_address TEXT,
    bank_details TEXT,
    contact_person VARCHAR(100),
    phone VARCHAR(20),
    email VARCHAR(100),
    rating DECIMAL(3,2) DEFAULT 0,
    status VARCHAR(20) DEFAULT 'active',
    created_at TIMESTAMP DEFAULT NOW()
);

-- –ì–æ—Ä–æ–¥–∞ –±–∞–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
CREATE TABLE partner_locations (
    id SERIAL PRIMARY KEY,
    partner_id INTEGER REFERENCES partners(id),
    city VARCHAR(100) NOT NULL,
    region VARCHAR(100),
    is_main BOOLEAN DEFAULT false
);

-- –†–µ–π—Ç–∏–Ω–≥–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
CREATE TABLE partner_ratings (
    id SERIAL PRIMARY KEY,
    partner_id INTEGER REFERENCES partners(id),
    lead_id INTEGER REFERENCES leads(id),
    punctuality INTEGER CHECK (punctuality BETWEEN 1 AND 5),
    quality INTEGER CHECK (quality BETWEEN 1 AND 5),
    price INTEGER CHECK (price BETWEEN 1 AND 5),
    communication INTEGER CHECK (communication BETWEEN 1 AND 5),
    overall_rating INTEGER CHECK (overall_rating BETWEEN 1 AND 5),
    comment_type VARCHAR(50),
    custom_comment TEXT,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á–µ—Ç
CREATE TABLE management_records (
    id SERIAL PRIMARY KEY,
    date DATE NOT NULL,
    route_from VARCHAR(100),
    route_to VARCHAR(100),
    client_name VARCHAR(200),
    partner_name VARCHAR(200),
    incoming_amount DECIMAL(10,2),
    partner_cost DECIMAL(10,2),
    ebitda DECIMAL(10,2),
    tax_rate DECIMAL(5,2) DEFAULT 7.0,
    tax_amount DECIMAL(10,2),
    net_profit DECIMAL(10,2),
    margin_percent DECIMAL(5,2),
    volume_weight DECIMAL(8,2),
    volume_units VARCHAR(20),
    status VARCHAR(50),
    notes TEXT,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –®–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
CREATE TABLE document_templates (
    id SERIAL PRIMARY KEY,
    name VARCHAR(200) NOT NULL,
    type VARCHAR(50),
    category VARCHAR(50),
    description TEXT,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –ë–ª–æ–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤
CREATE TABLE template_blocks (
    id SERIAL PRIMARY KEY,
    template_id INTEGER REFERENCES document_templates(id),
    block_type VARCHAR(50),
    block_order INTEGER,
    content TEXT,
    is_required BOOLEAN DEFAULT true,
    is_editable BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –ó–µ—Ä–∫–∞–ª—å–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã
CREATE TABLE contract_pairs (
    id SERIAL PRIMARY KEY,
    client_contract_id INTEGER REFERENCES generated_documents(id),
    partner_contract_id INTEGER REFERENCES generated_documents(id),
    lead_id INTEGER REFERENCES leads(id),
    sync_status VARCHAR(50) DEFAULT 'synced',
    created_at TIMESTAMP DEFAULT NOW()
);

-- –ú–∞—Ä—à—Ä—É—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
CREATE TABLE route_data (
    id SERIAL PRIMARY KEY,
    contract_pair_id INTEGER REFERENCES contract_pairs(id),
    route_from VARCHAR(100),
    route_to VARCHAR(100),
    loading_date DATE,
    loading_time_from TIME,
    loading_time_to TIME,
    unloading_date DATE,
    unloading_time TIME,
    loading_address TEXT,
    unloading_address TEXT,
    cargo_name VARCHAR(200),
    cargo_weight DECIMAL(10,2),
    cargo_volume DECIMAL(10,2),
    cargo_packaging VARCHAR(100),
    loading_method VARCHAR(50),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

---

## üéØ **1. –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–Ø–í–ö–ê–ú–ò**

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫ —Å —Å–∞–π—Ç–∞
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –∑–∞—è–≤–æ–∫
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
- ‚úÖ –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### **–°—Ç–∞—Ç—É—Å—ã –∑–∞—è–≤–æ–∫:**
```javascript
const LEAD_STATUSES = {
  new: '–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞',
  processing: '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ',
  partner_search: '–ü–æ–∏—Å–∫ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞',
  partner_found: '–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫ –Ω–∞–π–¥–µ–Ω',
  in_progress: '–í —Ä–∞–±–æ—Ç–µ',
  completed: '–í—ã–ø–æ–ª–Ω–µ–Ω–æ',
  cancelled: '–û—Ç–º–µ–Ω–µ–Ω–æ',
  conflict: '–ö–æ–Ω—Ñ–ª–∏–∫—Ç'
};
```

### **API Endpoints:**
```python
# –ó–∞—è–≤–∫–∏
@app.get("/api/v1/leads/")
async def get_leads(status: str = None, source: str = None):
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π"""
    pass

@app.post("/api/v1/leads/")
async def create_lead(lead: LeadCreate):
    """–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É"""
    pass

@app.put("/api/v1/leads/{lead_id}")
async def update_lead(lead_id: int, lead: LeadUpdate):
    """–û–±–Ω–æ–≤–∏—Ç—å –∑–∞—è–≤–∫—É"""
    pass

@app.patch("/api/v1/leads/{lead_id}/status")
async def update_lead_status(lead_id: int, status: str):
    """–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏"""
    pass
```

---

## ü§ù **2. –†–ï–ï–°–¢–† –ü–ê–†–¢–ù–ï–†–û–í-–ü–ï–†–ï–í–û–ó–ß–ò–ö–û–í**

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ë–∞–∑–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –ì–µ–æ–≥—Ä–∞—Ñ–∏—è —Ä–∞–±–æ—Ç—ã (–≥–æ—Ä–æ–¥–∞ –±–∞–∑–∏—Ä–æ–≤–∞–Ω–∏—è)
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–±–æ—Ç—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤

### **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤:**
```javascript
const RATING_COMMENTS = {
  good: '–•–æ—Ä–æ—à–∏–π –ø–∞—Ä—Ç–Ω–µ—Ä',
  average: '–°—Ä–µ–¥–Ω–∏–π',
  conflict: '–ö–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã–π',
  fast: '–ë—ã—Å—Ç—Ä—ã–π',
  slow: '–î–æ–ª–≥–∏–π',
  expensive: '–î–æ—Ä–æ–≥–æ–π',
  cheap: '–î–µ—à–µ–≤—ã–π',
  large_volumes: '–ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã',
  small_cargo: '–ú–µ–ª–∫–∏–µ –≥—Ä—É–∑—ã',
  intercity: '–ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω–∏–µ',
  local: '–ì–æ—Ä–æ–¥—Å–∫–∏–µ'
};

class PartnerRating {
  constructor(partnerId, leadId) {
    this.partnerId = partnerId;
    this.leadId = leadId;
  }
  
  async submitRating(ratingData) {
    const response = await fetch('/api/v1/partner-ratings', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        partner_id: this.partnerId,
        lead_id: this.leadId,
        punctuality: ratingData.punctuality,
        quality: ratingData.quality,
        price: ratingData.price,
        communication: ratingData.communication,
        overall_rating: ratingData.overallRating,
        comment_type: ratingData.commentType,
        custom_comment: ratingData.customComment
      })
    });
    
    return response.json();
  }
}
```

### **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞:**
```html
<!-- pages/partners/view.html -->
<div class="partner-card">
  <div class="partner-header">
    <h2>{{partner.company_name}}</h2>
    <div class="partner-rating">
      <span class="rating-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
      <span class="rating-score">{{partner.rating}}</span>
    </div>
  </div>
  
  <div class="partner-info">
    <div class="info-section">
      <h3>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
      <p><strong>–ò–ù–ù:</strong> {{partner.inn}}</p>
      <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{partner.phone}}</p>
      <p><strong>Email:</strong> {{partner.email}}</p>
    </div>
    
    <div class="info-section">
      <h3>–ì–æ—Ä–æ–¥–∞ –±–∞–∑–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
      <div class="locations">
        {{#each partner.locations}}
          <span class="location-tag">{{this.city}}</span>
        {{/each}}
      </div>
    </div>
    
    <div class="info-section">
      <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã</h3>
      <div class="ratings-list">
        {{#each partner.ratings}}
          <div class="rating-item">
            <div class="rating-header">
              <span class="rating-type {{this.comment_type}}">{{this.comment_type_text}}</span>
              <span class="rating-date">{{this.created_at}}</span>
            </div>
            <p>{{this.custom_comment}}</p>
          </div>
        {{/each}}
      </div>
    </div>
  </div>
</div>
```

---

## üí∞ **3. –£–ü–†–ê–í–õ–ï–ù–ß–ï–°–ö–ò–ô –£–ß–ï–¢**

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö (2 –ø–æ–ª—è)
- ‚úÖ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚úÖ –û—Ç—á–µ—Ç—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç

### **–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–æ–≤:**
```javascript
class ManagementCalculator {
  constructor() {
    this.defaultTaxRate = 7.0; // –£–°–ù + –ü–§–†
    this.fixedRates = {
      '–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç 1': { incoming: 19000, partner: 12000 },
      '–ú–æ—Å–∫–≤–∞-–°–ü–±': { incoming: 25000, partner: 15000 }
    };
  }
  
  // –†–∞—Å—á–µ—Ç –æ—Ç –≤—Ö–æ–¥—è—â–µ–π —Å—É–º–º—ã
  calculateFromIncoming(incomingAmount, clientType = 'new') {
    let partnerCost;
    
    if (clientType === 'regular') {
      partnerCost = incomingAmount * 0.63; // 63% –æ—Ç –≤—Ö–æ–¥—è—â–µ–π
    } else {
      partnerCost = this.askForPartnerCost();
    }
    
    return this.calculateAll(incomingAmount, partnerCost);
  }
  
  // –†–∞—Å—á–µ—Ç –æ—Ç —Ü–µ–Ω—ã –ø–∞—Ä—Ç–Ω–µ—Ä–∞
  calculateFromPartner(partnerCost, route = '') {
    let incomingAmount;
    
    if (this.fixedRates[route]) {
      incomingAmount = this.fixedRates[route].incoming;
    } else {
      incomingAmount = this.askForIncomingAmount();
    }
    
    return this.calculateAll(incomingAmount, partnerCost);
  }
  
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫
  calculateAll(incoming, partner) {
    const ebitda = incoming - partner;
    const tax = incoming * (this.defaultTaxRate / 100);
    const netProfit = ebitda - tax;
    const margin = (netProfit / incoming) * 100;
    
    return {
      incoming,
      partner,
      ebitda,
      tax,
      netProfit,
      margin,
      partnerShare: (partner / incoming) * 100,
      taxBurden: (tax / incoming) * 100,
      profitShare: (ebitda / incoming) * 100
    };
  }
}
```

### **–ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö:**
```html
<!-- pages/management/quick-entry.html -->
<div class="quick-entry">
  <h3>–ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
  
  <div class="input-type-selector">
    <button class="btn-tab active" data-type="incoming">
      –í–≤–µ—Å—Ç–∏ –≤—Ö–æ–¥—è—â—É—é —Å—É–º–º—É
    </button>
    <button class="btn-tab" data-type="partner">
      –í–≤–µ—Å—Ç–∏ —Ü–µ–Ω—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞
    </button>
  </div>
  
  <div class="input-form" id="incoming-form">
    <div class="form-group">
      <label>–í—Ö–æ–¥—è—â–∞—è —Å—É–º–º–∞ (–æ—Ç –∫–ª–∏–µ–Ω—Ç–∞)</label>
      <input type="number" id="incoming-amount" placeholder="19000">
    </div>
    
    <div class="form-group">
      <label>–¢–∏–ø –∫–ª–∏–µ–Ω—Ç–∞</label>
      <select id="client-type">
        <option value="new">–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç</option>
        <option value="regular">–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç</option>
      </select>
    </div>
    
    <div class="form-group" id="partner-cost-group" style="display: none;">
      <label>–¶–µ–Ω–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–∞</label>
      <input type="number" id="partner-cost" placeholder="12000">
    </div>
    
    <button class="btn-calculate" onclick="calculateFromIncoming()">
      –†–∞—Å—Å—á–∏—Ç–∞—Ç—å
    </button>
  </div>
  
  <div class="calculation-result" id="result" style="display: none;">
    <h4>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞:</h4>
    <div class="result-grid">
      <div class="result-item">
        <span>EBITDA:</span>
        <span id="result-ebitda">0 ‚ÇΩ</span>
      </div>
      <div class="result-item">
        <span>–ù–∞–ª–æ–≥–∏ (7%):</span>
        <span id="result-tax">0 ‚ÇΩ</span>
      </div>
      <div class="result-item">
        <span>–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å:</span>
        <span id="result-net">0 ‚ÇΩ</span>
      </div>
      <div class="result-item">
        <span>–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å:</span>
        <span id="result-margin">0%</span>
      </div>
    </div>
    
    <button class="btn-save" onclick="saveOperation()">
      –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é
    </button>
  </div>
</div>
```

---

## üìÑ **4. –ö–û–ù–°–¢–†–£–ö–¢–û–† –î–û–ö–£–ú–ï–ù–¢–û–í**

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ë–ª–æ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —à–∞–±–ª–æ–Ω–æ–≤
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚úÖ –ó–µ—Ä–∫–∞–ª—å–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF

### **–¢–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:**
```javascript
const DOCUMENT_TYPES = {
  // –î–æ–≥–æ–≤–æ—Ä—ã
  client_contract: '–î–æ–≥–æ–≤–æ—Ä —Å –∫–ª–∏–µ–Ω—Ç–æ–º',
  partner_contract: '–î–æ–≥–æ–≤–æ—Ä —Å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º',
  application: '–ó–∞—è–≤–∫–∞-–¥–æ–≥–æ–≤–æ—Ä',
  
  // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  arrival_notice: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∏–±—ã—Ç–∏–∏',
  delay_notice: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–¥–µ—Ä–∂–∫–µ',
  ready_notice: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏',
  
  // –ê–∫—Ç—ã
  cargo_handover: '–ê–∫—Ç –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏',
  work_completed: '–ê–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç',
  damage_report: '–ê–∫—Ç –æ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–∏',
  
  // –ü—Ä–µ—Ç–µ–Ω–∑–∏–∏
  delay_claim: '–ü—Ä–µ—Ç–µ–Ω–∑–∏—è –æ –∑–∞–¥–µ—Ä–∂–∫–µ',
  damage_claim: '–ü—Ä–µ—Ç–µ–Ω–∑–∏—è –æ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–∏',
  quality_claim: '–ü—Ä–µ—Ç–µ–Ω–∑–∏—è –æ –∫–∞—á–µ—Å—Ç–≤–µ'
};
```

### **–°–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–æ–≤:**
```javascript
const BLOCK_TYPES = {
  header: {
    name: '–ó–∞–≥–æ–ª–æ–≤–æ–∫',
    template: '–î–æ–≥–æ–≤–æ—Ä-–∑–∞—è–≤–∫–∞ –Ω–∞ –ø–µ—Ä–µ–≤–æ–∑–∫—É –≥—Ä—É–∑–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º\nNo {{contract_number}}',
    variables: ['contract_number', 'contract_date']
  },
  
  loading: {
    name: '–ü–æ–≥—Ä—É–∑–∫–∞',
    template: `–ü–æ–≥—Ä—É–∑–∫–∞:
–ì—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: {{shipper_name}}
–î–∞—Ç–∞ –ø–æ–≥—Ä—É–∑–∫–∏: {{loading_date}} —Å {{loading_time_from}} –¥–æ {{loading_time_to}}
–ê–¥—Ä–µ—Å –ø–æ–≥—Ä—É–∑–∫–∏: {{loading_address}}
–¢–µ–ª–µ—Ñ–æ–Ω: {{loading_phone}} {{loading_contact}}`,
    variables: ['shipper_name', 'loading_date', 'loading_time_from', 'loading_time_to', 'loading_address', 'loading_phone', 'loading_contact']
  },
  
  unloading: {
    name: '–í—ã–≥—Ä—É–∑–∫–∞',
    template: `–í—ã–≥—Ä—É–∑–∫–∞:
–ì—Ä—É–∑–æ–ø–æ–ª—É—á–∞—Ç–µ–ª—å: {{consignee_name}}
–î–∞—Ç–∞ –≤—ã–≥—Ä—É–∑–∫–∏: {{unloading_date}} –¥–æ {{unloading_time}}
–ê–¥—Ä–µ—Å –≤—ã–≥—Ä—É–∑–∫–∏: {{unloading_address}}`,
    variables: ['consignee_name', 'unloading_date', 'unloading_time', 'unloading_address']
  },
  
  cargo: {
    name: '–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä—É–∑–∞',
    template: `–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä—É–∑–∞:
–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞: {{cargo_name}}
–í–µ—Å: {{cargo_weight}} –∫–≥
–£–ø–∞–∫–æ–≤–∫–∞: {{cargo_packaging}}
–°–ø–æ—Å–æ–± –ø–æ–≥—Ä—É–∑–∫–∏: {{loading_method}}`,
    variables: ['cargo_name', 'cargo_weight', 'cargo_packaging', 'loading_method']
  },
  
  payment: {
    name: '–°—Ç–æ–∏–º–æ—Å—Ç—å –∏ –æ–ø–ª–∞—Ç–∞',
    template: `–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–∑–∫–∏: {{total_amount}} —Ä—É–±. ({{amount_in_words}})
–§–æ—Ä–º–∞ –∏ —Å—Ä–æ–∫ –æ–ø–ª–∞—Ç—ã: {{payment_terms}}`,
    variables: ['total_amount', 'amount_in_words', 'payment_terms']
  },
  
  conditions: {
    name: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è',
    template: `{{custom_conditions}}`,
    variables: ['custom_conditions']
  },
  
  driver: {
    name: '–î–∞–Ω–Ω—ã–µ –≤–æ–¥–∏—Ç–µ–ª—è/–¢–°',
    template: `–í—ã–¥–µ–ª–µ–Ω–Ω—ã–π –ø–æ–¥–≤–∏–∂–Ω–æ–π —Å–æ—Å—Ç–∞–≤:
{{driver_name}} –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: {{driver_birth_date}}
{{driver_passport}}
{{vehicle_info}}`,
    variables: ['driver_name', 'driver_birth_date', 'driver_passport', 'vehicle_info']
  },
  
  parties: {
    name: '–†–µ–∫–≤–∏–∑–∏—Ç—ã —Å—Ç–æ—Ä–æ–Ω',
    template: `–ó–∞–∫–∞–∑—á–∏–∫
{{client_details}}

–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
{{partner_details}}`,
    variables: ['client_details', 'partner_details']
  },
  
  signatures: {
    name: '–ü–æ–¥–ø–∏—Å–∏',
    template: `________/{{client_signature}}
{{client_name}} –±–µ–∑ –ø–µ—á–∞—Ç–∏

_______________/{{partner_signature}}
{{partner_name}}`,
    variables: ['client_signature', 'client_name', 'partner_signature', 'partner_name']
  }
};
```

### **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:**
```javascript
class DocumentGenerator {
  constructor() {
    this.variables = {};
    this.template = '';
  }
  
  // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∑–∞—è–≤–∫–∏
  async loadFromLead(leadId) {
    const response = await fetch(`/api/v1/leads/${leadId}`);
    const lead = await response.json();
    
    this.variables = {
      contract_number: this.generateContractNumber(),
      contract_date: new Date().toLocaleDateString('ru-RU'),
      shipper_name: lead.client_name,
      loading_date: lead.loading_date,
      loading_address: lead.loading_address,
      consignee_name: lead.consignee_name,
      unloading_address: lead.unloading_address,
      cargo_name: lead.cargo_name,
      cargo_weight: lead.cargo_weight,
      total_amount: lead.total_amount,
      amount_in_words: this.numberToWords(lead.total_amount)
    };
    
    return this.variables;
  }
  
  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
  async generateDocument(templateId, variables) {
    const response = await fetch('/api/v1/documents/generate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        template_id: templateId,
        variables: variables
      })
    });
    
    const result = await response.json();
    return result.file_path;
  }
  
  // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–∞ –≤ —Å–ª–æ–≤–∞
  numberToWords(number) {
    if (number === 18000) return '–≤–æ—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å —Ç—ã—Å—è—á —Ä—É–±–ª–µ–π 00 –∫–æ–ø–µ–µ–∫';
    if (number === 25000) return '–¥–≤–∞–¥—Ü–∞—Ç—å –ø—è—Ç—å —Ç—ã—Å—è—á —Ä—É–±–ª–µ–π 00 –∫–æ–ø–µ–µ–∫';
    return '—Å—É–º–º–∞ –ø—Ä–æ–ø–∏—Å—å—é';
  }
  
  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ –¥–æ–≥–æ–≤–æ—Ä–∞
  generateContractNumber() {
    const date = new Date();
    const year = date.getFullYear().toString().slice(-2);
    const month = (date.getMonth() + 1).toString().padStart(2, '0');
    const random = Math.floor(Math.random() * 9999).toString().padStart(4, '0');
    return `${year}${month}${random}`;
  }
}
```

---

## üîÑ **5. –ó–ï–†–ö–ê–õ–¨–ù–´–ï –î–û–ì–û–í–û–†–´**

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ì–∏–±–∫–∏–µ —à–∞–±–ª–æ–Ω—ã —É—Å–ª–æ–≤–∏–π
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–∏ –¥–æ–≥–æ–≤–æ—Ä–æ–≤

### **–°–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
```javascript
class ContractMirroring {
  constructor() {
    this.syncFields = [
      'route_from', 'route_to', 'loading_date', 'loading_time_from', 
      'loading_time_to', 'unloading_date', 'unloading_time',
      'loading_address', 'unloading_address', 'cargo_name', 
      'cargo_weight', 'cargo_volume', 'cargo_packaging', 'loading_method'
    ];
  }
  
  // –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä—ã –∑–µ—Ä–∫–∞–ª—å–Ω—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤
  async createMirrorContracts(leadId, clientTemplateId, partnerTemplateId) {
    const lead = await this.getLead(leadId);
    
    // –°–æ–∑–¥–∞–µ–º –º–∞—Ä—à—Ä—É—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    const routeData = await this.createRouteData(lead);
    
    // –°–æ–∑–¥–∞–µ–º –¥–æ–≥–æ–≤–æ—Ä —Å –∫–ª–∏–µ–Ω—Ç–æ–º
    const clientContract = await this.createContract(
      clientTemplateId, 
      lead, 
      'client',
      routeData
    );
    
    // –°–æ–∑–¥–∞–µ–º –¥–æ–≥–æ–≤–æ—Ä —Å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º
    const partnerContract = await this.createContract(
      partnerTemplateId, 
      lead, 
      'partner',
      routeData
    );
    
    // –°–≤—è–∑—ã–≤–∞–µ–º –¥–æ–≥–æ–≤–æ—Ä—ã
    const contractPair = await this.linkContracts(
      clientContract.id, 
      partnerContract.id, 
      routeData.id
    );
    
    return { clientContract, partnerContract, contractPair };
  }
  
  // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
  async syncContractChanges(contractId, changedFields) {
    const contractPair = await this.getContractPair(contractId);
    const otherContractId = contractPair.client_contract_id === contractId 
      ? contractPair.partner_contract_id 
      : contractPair.client_contract_id;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ä—à—Ä—É—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    await this.updateRouteData(contractPair.route_data_id, changedFields);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä
    await this.updateContract(otherContractId, changedFields);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    await this.updateSyncStatus(contractPair.id, 'synced');
  }
}
```

### **–®–∞–±–ª–æ–Ω—ã —É—Å–ª–æ–≤–∏–π:**
```javascript
const CONTRACT_CONDITIONS = {
  client: {
    standard: {
      name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞',
      content: `–î–∞–Ω–Ω–∞—è –∑–∞—è–≤–∫–∞ –∏–º–µ–µ—Ç —Å–∏–ª—É –¥–æ–≥–æ–≤–æ—Ä–∞ –Ω–∞ —Ä–∞–∑–æ–≤—É—é –¥–æ—Å—Ç–∞–≤–∫—É.
–ù–∞—Å—Ç–æ—è—â–∞—è –∑–∞—è–≤–∫–∞, –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –ø–æ —Å–µ—Ç–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –ø—Ä–∏–∑–Ω–∞–µ—Ç—Å—è –°—Ç–æ—Ä–æ–Ω–∞–º–∏ —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω–æ–π –∑–∞—è–≤–∫–µ –Ω–∞ –±—É–º–∞–∂–Ω–æ–º –Ω–æ—Å–∏—Ç–µ–ª–µ –∏ –∏–º–µ–µ—Ç –ø–æ–ª–Ω—É—é —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é —Å–∏–ª—É.
–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫ –Ω–µ—Å–µ—Ç –ø–æ–ª–Ω—É—é –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–∑–∫–µ –≥—Ä—É–∑–∞ –≤ –ø–µ—Ä–∏–æ–¥ –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥.`
    },
    
    premium: {
      name: '–ü—Ä–µ–º–∏—É–º —É—Å–ª–æ–≤–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞',
      content: `–î–∞–Ω–Ω–∞—è –∑–∞—è–≤–∫–∞ –∏–º–µ–µ—Ç —Å–∏–ª—É –¥–æ–≥–æ–≤–æ—Ä–∞ –Ω–∞ —Ä–∞–∑–æ–≤—É—é –¥–æ—Å—Ç–∞–≤–∫—É.
–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –≤ —Å—Ä–æ–∫ —Å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–µ–π –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ —Å—Ä–æ–∫–æ–≤.
–ü–æ–ª–Ω–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –≥—Ä—É–∑–∞ –Ω–∞ —Å—É–º–º—É –¥–æ 1,000,000 —Ä—É–±–ª–µ–π.
–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä.`
    }
  },
  
  partner: {
    standard: {
      name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è',
      content: `–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ–±—è–∑—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–∑–∫—É –≥—Ä—É–∑–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å–ª–æ–≤–∏—è–º–∏ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞.
–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º —Ä–∞–∑–≤–µ—Å–æ–≤–∫–∏ –ø–æ –æ—Å—è–º –∏ –æ–±—â–µ–π –º–∞—Å—Å–µ –ª–µ–∂–∏—Ç –Ω–∞ –ü–µ—Ä–µ–≤–æ–∑—á–∏–∫–µ.
–û—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç –º–∞—Ä—à—Ä—É—Ç–∞ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –ø–∏—Å—å–º–µ–Ω–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –ó–∞–∫–∞–∑—á–∏–∫–∞.`
    },
    
    strict: {
      name: '–°—Ç—Ä–æ–≥–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è',
      content: `–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ–±—è–∑—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–∑–∫—É –≥—Ä—É–∑–∞ –≤ —Å—Ç—Ä–æ–≥–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å–ª–æ–≤–∏—è–º–∏.
–®—Ç—Ä–∞—Ñ –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ —Å—Ä–æ–∫–æ–≤: 5,000 —Ä—É–±–ª–µ–π –∑–∞ –∫–∞–∂–¥—ã–π —á–∞—Å –∑–∞–¥–µ—Ä–∂–∫–∏.
–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–≥—Ä—É–∑–∫–∏ –∏ –≤—ã–≥—Ä—É–∑–∫–∏.
–ü–æ–ª–Ω–∞—è –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –≥—Ä—É–∑–∞.`
    }
  }
};
```

---

## üìä **6. –ê–ù–ê–õ–ò–¢–ò–ö–ê –ò –û–¢–ß–ï–¢–´**

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –î–∞—à–±–æ—Ä–¥ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- ‚úÖ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚úÖ –û—Ç—á–µ—Ç—ã –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### **–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
```javascript
class BusinessMetrics {
  // –°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º
  async calculateAverageMarginByClient(operations) {
    const clientMargins = {};
    operations.forEach(op => {
      if (!clientMargins[op.client]) {
        clientMargins[op.client] = [];
      }
      clientMargins[op.client].push(op.margin);
    });
    
    return Object.keys(clientMargins).map(client => ({
      client,
      avgMargin: clientMargins[client].reduce((a, b) => a + b, 0) / clientMargins[client].length
    }));
  }
  
  // –¢–æ–ø –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
  async calculateTopRoutes(operations) {
    const routeProfits = {};
    operations.forEach(op => {
      const route = `${op.routeFrom} - ${op.routeTo}`;
      if (!routeProfits[route]) {
        routeProfits[route] = { totalProfit: 0, count: 0 };
      }
      routeProfits[route].totalProfit += op.netProfit;
      routeProfits[route].count++;
    });
    
    return Object.keys(routeProfits)
      .map(route => ({
        route,
        totalProfit: routeProfits[route].totalProfit,
        avgProfit: routeProfits[route].totalProfit / routeProfits[route].count
      }))
      .sort((a, b) => b.totalProfit - a.totalProfit);
  }
  
  // –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü
  async calculateForecast(operations) {
    const monthlyData = {};
    operations.forEach(op => {
      const month = op.date.substring(0, 7); // YYYY-MM
      if (!monthlyData[month]) {
        monthlyData[month] = { revenue: 0, profit: 0, count: 0 };
      }
      monthlyData[month].revenue += op.incoming;
      monthlyData[month].profit += op.netProfit;
      monthlyData[month].count++;
    });
    
    const months = Object.keys(monthlyData).sort();
    const lastMonth = monthlyData[months[months.length - 1]];
    const avgGrowth = 1.05; // 5% —Ä–æ—Å—Ç –≤ –º–µ—Å—è—Ü
    
    return {
      nextMonthRevenue: lastMonth.revenue * avgGrowth,
      nextMonthProfit: lastMonth.profit * avgGrowth,
      nextMonthCount: Math.round(lastMonth.count * avgGrowth)
    };
  }
}
```

---

## üöÄ **–ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò**

### **–≠—Ç–∞–ø 1: MVP (2-3 –Ω–µ–¥–µ–ª–∏)**
1. ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
2. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
3. ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ (CRUD)
4. ‚úÖ –†–µ–µ—Å—Ç—Ä –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
5. ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
6. ‚úÖ –ü—Ä–æ—Å—Ç–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π —É—á–µ—Ç

### **–≠—Ç–∞–ø 2: –î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç (2-3 –Ω–µ–¥–µ–ª–∏)**
1. üîÑ –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
2. üîÑ –®–∞–±–ª–æ–Ω—ã –¥–æ–≥–æ–≤–æ—Ä–æ–≤
3. üîÑ –ó–µ—Ä–∫–∞–ª—å–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã
4. üîÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
5. üîÑ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –∞–∫—Ç–æ–≤

### **–≠—Ç–∞–ø 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)**
1. üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
2. üîÑ –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –∑–∞—è–≤–æ–∫
3. üîÑ Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
4. üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### **–≠—Ç–∞–ø 4: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (1-2 –Ω–µ–¥–µ–ª–∏)**
1. üîÑ –î–∞—à–±–æ—Ä–¥ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
2. üîÑ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã
3. üîÑ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
4. üîÑ –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–≠—Ç–∞–ø 5: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (1 –Ω–µ–¥–µ–ª—è)**
1. üîÑ UI/UX —É–ª—É—á—à–µ–Ω–∏—è
2. üîÑ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. üîÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üí° **–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–ò–ß–ò**

### **–£–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏:**
```javascript
class SmartSuggestions {
  // –ü–æ–¥—Å–∫–∞–∑–∫–∞ —Ü–µ–Ω—ã –¥–ª—è –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
  async suggestPrice(routeFrom, routeTo, weight) {
    const similarRoutes = await this.findSimilarRoutes(routeFrom, routeTo);
    if (similarRoutes.length > 0) {
      const avgPrice = similarRoutes.reduce((sum, r) => sum + r.incoming, 0) / similarRoutes.length;
      return {
        suggestedIncoming: avgPrice,
        suggestedPartner: avgPrice * 0.63,
        confidence: 'high'
      };
    }
    return null;
  }
  
  // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–∏–∑–∫–æ–π –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
  checkMargin(calculatedMargin) {
    if (calculatedMargin < 15) {
      return {
        warning: '–ù–∏–∑–∫–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å!',
        suggestion: '–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏–ª–∏ –ø–æ–∏—Å–∫ –¥—Ä—É–≥–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞',
        type: 'danger'
      };
    }
    if (calculatedMargin < 25) {
      return {
        warning: '–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ',
        suggestion: '–ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞–π—Ç–∏ –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞',
        type: 'warning'
      };
    }
    return null;
  }
}
```

### **–ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è:**
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- ‚úÖ Touch-friendly –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- ‚úÖ –û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º

### **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- ‚úÖ Telegram –±–æ—Ç
- ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ API –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤

---

## üìû **–ü–û–î–î–ï–†–ñ–ö–ê –ò –†–ê–ó–í–ò–¢–ò–ï**

### **–ö–æ–Ω—Ç–∞–∫—Ç—ã:**
- **Email:** avtogost77@gmail.com
- **Telegram:** @avtogost77
- **–¢–µ–ª–µ—Ñ–æ–Ω:** +7 916 272-09-32

### **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/api.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](docs/user-guide.md)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/technical.md)

---

**¬© 2025 –ê–≤—Ç–æ–ì–û–°–¢77. –ü–æ–ª–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω CRM —Å–∏—Å—Ç–µ–º—ã.**
