# ü§ñ AI-–ê–°–°–ò–°–¢–ï–ù–¢ –î–õ–Ø AVTOGOST77 - –ü–õ–ê–ù –í–ù–ï–î–†–ï–ù–ò–Ø

## üìã –û–ì–õ–ê–í–õ–ï–ù–ò–ï
1. [–ö–æ–Ω—Ü–µ–ø—Ü–∏—è](#–∫–æ–Ω—Ü–µ–ø—Ü–∏—è)
2. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
3. [–≠—Ç–∞–ø 1: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#—ç—Ç–∞–ø-1-–ª–æ–∫–∞–ª—å–Ω–∞—è-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
4. [–≠—Ç–∞–ø 2: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏](#—ç—Ç–∞–ø-2-–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏)
5. [–≠—Ç–∞–ø 3: Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#—ç—Ç–∞–ø-3-frontend-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
6. [–≠—Ç–∞–ø 4: Backend API](#—ç—Ç–∞–ø-4-backend-api)
7. [–≠—Ç–∞–ø 5: Deployment](#—ç—Ç–∞–ø-5-deployment)
8. [–≠—Ç–∞–ø 6: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ª—É—á—à–µ–Ω–∏–µ](#—ç—Ç–∞–ø-6-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-—É–ª—É—á—à–µ–Ω–∏–µ)

---

## üéØ –ö–û–ù–¶–ï–ü–¶–ò–Ø

### –ß—Ç–æ –¥–µ–ª–∞–µ–º:
–°–æ–∑–¥–∞—ë–º –ù–ê–°–¢–û–Ø–©–ï–ì–û AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–∞–π—Ç–∞ (–Ω–µ —Ñ–µ–π–∫–æ–≤—ã–π —á–∞—Ç —Å –∑–∞–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏), –∫–æ—Ç–æ—Ä—ã–π:
- ‚úÖ –û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ —Ç–∞—Ä–∏—Ñ–∞—Ö –∏ —É—Å–ª—É–≥–∞—Ö
- ‚úÖ –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏
- ‚úÖ –ü–æ–º–æ–≥–∞–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- ‚úÖ –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–µ—Ç –ø–æ —Å—Ä–æ–∫–∞–º –∏ –º–∞—Ä—à—Ä—É—Ç–∞–º
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ó–∞–ø–æ–º–∏–Ω–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

### –ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä—É—Ç–æ:
- üöÄ –ü–µ—Ä–≤—ã–π —á–µ—Å—Ç–Ω—ã–π AI –≤ –ª–æ–≥–∏—Å—Ç–∏–∫–µ
- üí∞ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (open source –º–æ–¥–µ–ª–∏)
- üîí –î–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è —É –Ω–∞—Å (self-hosted)
- ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã (–ª–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å)
- üéØ –¢–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (–æ–±—É—á–µ–Ω –Ω–∞ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö)

---

## üõ†Ô∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –°–¢–ï–ö

### Backend:
- **Ollama** - –∑–∞–ø—É—Å–∫ LLM –º–æ–¥–µ–ª–µ–π
- **Llama 2/3** –∏–ª–∏ **Mistral** - —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏
- **Node.js/Express** –∏–ª–∏ **Python/FastAPI** - API —Å–µ—Ä–≤–µ—Ä
- **Redis** - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- **PostgreSQL** - –∏—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤

### Frontend:
- **Vanilla JS** - –≤–∏–¥–∂–µ—Ç —á–∞—Ç–∞ (–±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- **WebSocket** - real-time –æ–±—â–µ–Ω–∏–µ
- **CSS** - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

### DevOps:
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Nginx** - reverse proxy
- **PM2** - process manager
- **Grafana** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

## üìù –≠–¢–ê–ü 1: –õ–û–ö–ê–õ–¨–ù–ê–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ê

### 1.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
# Linux/Mac
curl -fsSL https://ollama.ai/install.sh | sh

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
ollama --version

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
ollama serve
```

### 1.2 –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π

```bash
# –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å (7B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, ~4GB)
ollama pull llama2:7b-chat

# –ò–ª–∏ Mistral (–±—ã—Å—Ç—Ä–µ–µ, –º–µ–Ω—å—à–µ)
ollama pull mistral

# –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω–∞—è –º–æ–¥–µ–ª—å (–µ—Å–ª–∏ –Ω–∞–π–¥—ë–º)
ollama pull saiga-mistral:7b

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
ollama list
```

### 1.3 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
ollama run llama2

# API —Ç–µ—Å—Ç
curl -X POST http://localhost:11434/api/generate \
  -H "Content-Type: application/json" \
  -d '{
    "model": "llama2",
    "prompt": "–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –¥–æ—Å—Ç–∞–≤–∫–∞ –≥–∞–∑–µ–ª—å—é –∏–∑ –ú–æ—Å–∫–≤—ã –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥?",
    "stream": false
  }'
```

### 1.4 –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
mkdir avtogost-ai-assistant
cd avtogost-ai-assistant

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p {backend,frontend,data,scripts,docs}

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
npm init -y
git init
```

---

## üß† –≠–¢–ê–ü 2: –û–ë–£–ß–ï–ù–ò–ï –ú–û–î–ï–õ–ò

### 2.1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–º–ø–∞–Ω–∏–∏

–°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª `data/company-knowledge.json`:

```json
{
  "company": {
    "name": "–ê–≤—Ç–æ–ì–û–°–¢77",
    "description": "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∞—è—Å—è –Ω–∞ –≥—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–∫–∞—Ö",
    "philosophy": "–ü–æ–∫–∞ –≤—ã –æ—Ç–¥—ã—Ö–∞–µ—Ç–µ - –º—ã –¥–æ—Å—Ç–∞–≤–ª—è–µ–º",
    "contacts": {
      "phone": "+7 (916) 123-45-67",
      "whatsapp": "+7 (916) 123-45-67",
      "email": "avtogost77@gmail.com"
    }
  },
  "services": [
    {
      "name": "–ì—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–∫–∏ –ø–æ –ú–æ—Å–∫–≤–µ",
      "description": "–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–æ–≤ –ø–æ –ú–æ—Å–∫–≤–µ –∏ –æ–±–ª–∞—Å—Ç–∏",
      "vehicles": ["–ì–∞–∑–µ–ª—å", "5-—Ç–æ–Ω–Ω–∏–∫", "10-—Ç–æ–Ω–Ω–∏–∫", "20-—Ç–æ–Ω–Ω–∏–∫"],
      "base_price": 1200,
      "price_per_km": 40
    },
    {
      "name": "–ú–µ–∂–≥–æ—Ä–æ–¥",
      "routes": [
        {
          "from": "–ú–æ—Å–∫–≤–∞",
          "to": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
          "distance": 700,
          "duration": "8-10 —á–∞—Å–æ–≤",
          "prices": {
            "gazelle": 15000,
            "5t": 25000,
            "20t": 45000
          }
        },
        {
          "from": "–ú–æ—Å–∫–≤–∞",
          "to": "–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥",
          "distance": 420,
          "duration": "5-6 —á–∞—Å–æ–≤",
          "prices": {
            "gazelle": 9000,
            "5t": 15000,
            "20t": 28000
          }
        }
      ]
    }
  ],
  "faq": [
    {
      "question": "–ö–∞–∫ –±—ã—Å—Ç—Ä–æ –ø–æ–¥–∞—ë—Ç—Å—è –º–∞—à–∏–Ω–∞?",
      "answer": "–í –ø—Ä–µ–¥–µ–ª–∞—Ö –ú–æ—Å–∫–≤—ã - –æ—Ç 2 —á–∞—Å–æ–≤. –î–ª—è –º–µ–∂–≥–æ—Ä–æ–¥–∞ - –æ–±—ã—á–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å."
    },
    {
      "question": "–ï—Å—Ç—å –ª–∏ –≥—Ä—É–∑—á–∏–∫–∏?",
      "answer": "–î–∞, —É—Å–ª—É–≥–∏ –≥—Ä—É–∑—á–∏–∫–æ–≤ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ - 500‚ÇΩ/—á–∞—Å –∑–∞ —á–µ–ª–æ–≤–µ–∫–∞."
    }
  ]
}
```

### 2.2 –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–µ–Ω–µ—Ä–∏–Ω–≥–∞

–§–∞–π–ª `data/system-prompt.txt`:

```text
–¢—ã - AI-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –ê–≤—Ç–æ–ì–û–°–¢77. 

–í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê:
1. –û—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –≥—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–∫–∞–º–∏ –∏ —É—Å–ª—É–≥–∞–º–∏ –∫–æ–º–ø–∞–Ω–∏–∏
2. –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
3. –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å —Ç–æ—á–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ - –ø—Ä–µ–¥–ª–æ–∂–∏ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
4. –ë—É–¥—å –≤–µ–∂–ª–∏–≤ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–µ–Ω
5. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ —Å—É—â–µ—Å—Ç–≤—É
6. –ù–ï –ø—Ä–∏–¥—É–º—ã–≤–∞–π —Ü–µ–Ω—ã –∏ —É—Å–ª–æ–≤–∏—è
7. –ù–ï –æ–±–µ—â–∞–π —Ç–æ–≥–æ, —á–µ–≥–æ –Ω–µ—Ç –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π

–°–¢–ò–õ–¨ –û–ë–©–ï–ù–ò–Ø:
- –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π
- –ò—Å–ø–æ–ª—å–∑—É–π "–≤—ã" –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏
- –ò–∑–±–µ–≥–∞–π —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤
- –î–∞–≤–∞–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

–ë–ê–ó–ê –ó–ù–ê–ù–ò–ô:
[–ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ company-knowledge.json]

–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
```

### 2.3 Fine-tuning –º–æ–¥–µ–ª–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```python
# scripts/prepare_training_data.py
import json

def prepare_training_data():
    """–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è fine-tuning"""
    
    training_examples = [
        {
            "instruction": "–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –¥–æ—Å—Ç–∞–≤–∫–∞ –∏–∑ –ú–æ—Å–∫–≤—ã –≤ –°–ü–ë?",
            "input": "",
            "output": "–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ –ú–æ—Å–∫–≤—ã –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥:\n- –ì–∞–∑–µ–ª—å: –æ—Ç 15,000‚ÇΩ\n- 5-—Ç–æ–Ω–Ω–∏–∫: –æ—Ç 25,000‚ÇΩ\n- 20-—Ç–æ–Ω–Ω–∏–∫: –æ—Ç 45,000‚ÇΩ\n–í—Ä–µ–º—è –≤ –ø—É—Ç–∏: 8-10 —á–∞—Å–æ–≤."
        },
        {
            "instruction": "–ö–∞–∫ –±—ã—Å—Ç—Ä–æ –º–æ–∂–µ—Ç–µ –ø–æ–¥–∞—Ç—å –º–∞—à–∏–Ω—É?",
            "input": "–ù—É–∂–Ω–∞ –≥–∞–∑–µ–ª—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ú–ö–ê–î",
            "output": "–í –ø—Ä–µ–¥–µ–ª–∞—Ö –ú–æ—Å–∫–≤—ã –≥–∞–∑–µ–ª—å –ø–æ–¥–∞—ë–º –æ—Ç 2 —á–∞—Å–æ–≤. –¢–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –≤–∞—à–µ–≥–æ —Ä–∞–π–æ–Ω–∞. –ú–æ–≥—É –ø–æ–º–æ—á—å –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!"
        }
    ]
    
    with open('data/training_data.jsonl', 'w', encoding='utf-8') as f:
        for example in training_examples:
            f.write(json.dumps(example, ensure_ascii=False) + '\n')

if __name__ == "__main__":
    prepare_training_data()
```

---

## üé® –≠–¢–ê–ü 3: FRONTEND –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

### 3.1 –í–∏–¥–∂–µ—Ç —á–∞—Ç–∞

–§–∞–π–ª `frontend/chat-widget.js`:

```javascript
// AI Chat Widget –¥–ª—è –ê–≤—Ç–æ–ì–û–°–¢77
class AvtoGostAIChat {
    constructor(config = {}) {
        this.config = {
            apiUrl: config.apiUrl || 'http://localhost:3000/api/chat',
            position: config.position || 'bottom-right',
            primaryColor: config.primaryColor || '#FF6B00',
            ...config
        };
        
        this.messages = [];
        this.isOpen = false;
        this.init();
    }
    
    init() {
        this.createStyles();
        this.createHTML();
        this.attachEvents();
        this.addWelcomeMessage();
    }
    
    createStyles() {
        const style = document.createElement('style');
        style.textContent = `
            .ai-chat-widget {
                position: fixed;
                bottom: 20px;
                right: 20px;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                z-index: 9999;
            }
            
            .ai-chat-button {
                width: 60px;
                height: 60px;
                border-radius: 50%;
                background: ${this.config.primaryColor};
                color: white;
                border: none;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                display: flex;
                align-items: center;
                justify-content: center;
                transition: transform 0.3s;
            }
            
            .ai-chat-button:hover {
                transform: scale(1.1);
            }
            
            .ai-chat-window {
                position: absolute;
                bottom: 80px;
                right: 0;
                width: 380px;
                height: 600px;
                background: white;
                border-radius: 16px;
                box-shadow: 0 5px 40px rgba(0,0,0,0.16);
                display: none;
                flex-direction: column;
                overflow: hidden;
            }
            
            .ai-chat-window.open {
                display: flex;
                animation: slideUp 0.3s ease-out;
            }
            
            @keyframes slideUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .ai-chat-header {
                background: ${this.config.primaryColor};
                color: white;
                padding: 20px;
                display: flex;
                align-items: center;
                justify-content: space-between;
            }
            
            .ai-chat-messages {
                flex: 1;
                overflow-y: auto;
                padding: 20px;
                background: #f5f5f5;
            }
            
            .ai-message {
                margin-bottom: 16px;
                display: flex;
                gap: 12px;
                animation: fadeIn 0.3s ease-out;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            
            .ai-message.user {
                flex-direction: row-reverse;
            }
            
            .ai-message-content {
                max-width: 70%;
                padding: 12px 16px;
                border-radius: 16px;
                background: white;
                box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            }
            
            .ai-message.user .ai-message-content {
                background: ${this.config.primaryColor};
                color: white;
            }
            
            .ai-message-avatar {
                width: 36px;
                height: 36px;
                border-radius: 50%;
                background: #e0e0e0;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 18px;
            }
            
            .ai-chat-input-wrapper {
                padding: 20px;
                background: white;
                border-top: 1px solid #e0e0e0;
            }
            
            .ai-chat-input {
                width: 100%;
                padding: 12px 16px;
                border: 1px solid #e0e0e0;
                border-radius: 24px;
                outline: none;
                font-size: 14px;
                transition: border-color 0.3s;
            }
            
            .ai-chat-input:focus {
                border-color: ${this.config.primaryColor};
            }
            
            .ai-typing-indicator {
                display: none;
                padding: 12px 16px;
                background: white;
                border-radius: 16px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                width: fit-content;
            }
            
            .ai-typing-indicator.show {
                display: block;
            }
            
            .ai-typing-indicator span {
                display: inline-block;
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background: #999;
                margin: 0 2px;
                animation: typing 1.4s infinite;
            }
            
            .ai-typing-indicator span:nth-child(2) {
                animation-delay: 0.2s;
            }
            
            .ai-typing-indicator span:nth-child(3) {
                animation-delay: 0.4s;
            }
            
            @keyframes typing {
                0%, 80%, 100% {
                    transform: scale(1);
                    opacity: 0.5;
                }
                40% {
                    transform: scale(1.3);
                    opacity: 1;
                }
            }
            
            @media (max-width: 480px) {
                .ai-chat-window {
                    width: 100vw;
                    height: 100vh;
                    bottom: 0;
                    right: 0;
                    border-radius: 0;
                }
            }
        `;
        document.head.appendChild(style);
    }
    
    createHTML() {
        const widget = document.createElement('div');
        widget.className = 'ai-chat-widget';
        widget.innerHTML = `
            <button class="ai-chat-button" aria-label="–û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
            </button>
            
            <div class="ai-chat-window">
                <div class="ai-chat-header">
                    <div>
                        <h3 style="margin: 0; font-size: 18px;">AI –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç</h3>
                        <p style="margin: 4px 0 0; font-size: 14px; opacity: 0.9;">–ê–≤—Ç–æ–ì–û–°–¢77</p>
                    </div>
                    <button class="ai-chat-close" style="background: none; border: none; color: white; cursor: pointer; padding: 8px;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
                
                <div class="ai-chat-messages" id="ai-chat-messages">
                    <div class="ai-typing-indicator">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
                
                <div class="ai-chat-input-wrapper">
                    <input 
                        type="text" 
                        class="ai-chat-input" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..."
                        aria-label="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"
                    >
                </div>
            </div>
        `;
        
        document.body.appendChild(widget);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã
        this.widget = widget;
        this.button = widget.querySelector('.ai-chat-button');
        this.window = widget.querySelector('.ai-chat-window');
        this.closeBtn = widget.querySelector('.ai-chat-close');
        this.messagesContainer = widget.querySelector('.ai-chat-messages');
        this.input = widget.querySelector('.ai-chat-input');
        this.typingIndicator = widget.querySelector('.ai-typing-indicator');
    }
    
    attachEvents() {
        // –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —á–∞—Ç–∞
        this.button.addEventListener('click', () => this.toggle());
        this.closeBtn.addEventListener('click', () => this.close());
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        this.input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                this.sendMessage();
            }
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
        document.addEventListener('click', (e) => {
            if (this.isOpen && !this.widget.contains(e.target)) {
                this.close();
            }
        });
    }
    
    toggle() {
        this.isOpen ? this.close() : this.open();
    }
    
    open() {
        this.isOpen = true;
        this.window.classList.add('open');
        this.input.focus();
        
        // –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
        if (window.gtag) {
            gtag('event', 'chat_opened', {
                event_category: 'AI Chat',
                event_label: 'Widget Opened'
            });
        }
    }
    
    close() {
        this.isOpen = false;
        this.window.classList.remove('open');
    }
    
    addWelcomeMessage() {
        this.addMessage({
            text: '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø AI-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ê–≤—Ç–æ–ì–û–°–¢77. –ú–æ–≥—É –ø–æ–º–æ—á—å —Å —Ä–∞—Å—á—ë—Ç–æ–º —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏, –≤—ã–±–æ—Ä–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –Ω–∞—à–∏—Ö —É—Å–ª—É–≥–∞—Ö. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?',
            isUser: false
        });
    }
    
    addMessage({ text, isUser = false }) {
        const message = document.createElement('div');
        message.className = `ai-message ${isUser ? 'user' : 'ai'}`;
        
        const avatar = document.createElement('div');
        avatar.className = 'ai-message-avatar';
        avatar.textContent = isUser ? 'üë§' : 'ü§ñ';
        
        const content = document.createElement('div');
        content.className = 'ai-message-content';
        content.textContent = text;
        
        message.appendChild(avatar);
        message.appendChild(content);
        
        // –í—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–¥ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –ø–µ—á–∞—Ç–∏
        this.messagesContainer.insertBefore(message, this.typingIndicator);
        
        // –°–∫—Ä–æ–ª–ª–∏–º –≤–Ω–∏–∑
        this.scrollToBottom();
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        this.messages.push({ text, isUser, timestamp: new Date() });
    }
    
    scrollToBottom() {
        this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
    }
    
    showTyping() {
        this.typingIndicator.classList.add('show');
        this.scrollToBottom();
    }
    
    hideTyping() {
        this.typingIndicator.classList.remove('show');
    }
    
    async sendMessage() {
        const text = this.input.value.trim();
        if (!text) return;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        this.addMessage({ text, isUser: true });
        
        // –û—á–∏—â–∞–µ–º input
        this.input.value = '';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏
        this.showTyping();
        
        try {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ API
            const response = await fetch(this.config.apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: text,
                    context: this.messages.slice(-5) // –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
                })
            });
            
            if (!response.ok) {
                throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
            }
            
            const data = await response.json();
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏
            this.hideTyping();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç AI
            this.addMessage({ text: data.response });
            
            // –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
            if (window.gtag) {
                gtag('event', 'chat_message_sent', {
                    event_category: 'AI Chat',
                    event_label: 'User Message'
                });
            }
            
        } catch (error) {
            this.hideTyping();
            this.addMessage({ 
                text: '–ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º: +7 (916) 123-45-67' 
            });
            console.error('Chat error:', error);
        }
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', () => {
    window.avtoGostChat = new AvtoGostAIChat({
        apiUrl: '/api/chat',
        primaryColor: '#FF6B00'
    });
});
```

### 3.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å–∞–π—Ç

–î–æ–±–∞–≤–ª—è–µ–º –≤ `index.html` –ø–µ—Ä–µ–¥ `</body>`:

```html
<!-- AI Chat Widget -->
<script src="/assets/js/ai-chat-widget.js" defer></script>
```

---

## üîß –≠–¢–ê–ü 4: BACKEND API

### 4.1 Node.js API —Å–µ—Ä–≤–µ—Ä

–§–∞–π–ª `backend/server.js`:

```javascript
const express = require('express');
const cors = require('cors');
const axios = require('axios');
const Redis = require('redis');
const rateLimit = require('express-rate-limit');

const app = express();
const PORT = process.env.PORT || 3000;

// Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
const redis = Redis.createClient({
    url: process.env.REDIS_URL || 'redis://localhost:6379'
});

// Middleware
app.use(cors());
app.use(express.json());

// Rate limiting
const limiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
    max: 100 // –º–∞–∫—Å–∏–º—É–º 100 –∑–∞–ø—Ä–æ—Å–æ–≤
});
app.use('/api/chat', limiter);

// –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
const companyKnowledge = require('../data/company-knowledge.json');
const systemPrompt = require('fs').readFileSync('../data/system-prompt.txt', 'utf-8');

// –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞
function createPrompt(userMessage, context = []) {
    let prompt = systemPrompt.replace('[KNOWLEDGE_BASE]', JSON.stringify(companyKnowledge));
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    if (context.length > 0) {
        prompt += '\n\n–ü–†–ï–î–´–î–£–©–ò–ô –î–ò–ê–õ–û–ì:\n';
        context.forEach(msg => {
            prompt += `${msg.isUser ? '–ö–ª–∏–µ–Ω—Ç' : '–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç'}: ${msg.text}\n`;
        });
    }
    
    prompt += `\n–ö–ª–∏–µ–Ω—Ç: ${userMessage}\n–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç:`;
    
    return prompt;
}

// –û—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç —á–∞—Ç–∞
app.post('/api/chat', async (req, res) => {
    try {
        const { message, context = [] } = req.body;
        
        if (!message) {
            return res.status(400).json({ error: '–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º' });
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–µ—à
        const cacheKey = `chat:${message}`;
        const cached = await redis.get(cacheKey);
        if (cached) {
            return res.json({ response: cached });
        }
        
        // –°–æ–∑–¥–∞—ë–º –ø—Ä–æ–º–ø—Ç
        const prompt = createPrompt(message, context);
        
        // –ó–∞–ø—Ä–æ—Å –∫ Ollama
        const ollamaResponse = await axios.post('http://localhost:11434/api/generate', {
            model: 'llama2',
            prompt: prompt,
            stream: false,
            options: {
                temperature: 0.7,
                top_p: 0.9,
                max_tokens: 500
            }
        });
        
        const aiResponse = ollamaResponse.data.response;
        
        // –ö–µ—à–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ 1 —á–∞—Å
        await redis.setex(cacheKey, 3600, aiResponse);
        
        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
        console.log({
            timestamp: new Date(),
            userMessage: message,
            aiResponse: aiResponse.substring(0, 100) + '...'
        });
        
        res.json({ response: aiResponse });
        
    } catch (error) {
        console.error('Chat error:', error);
        res.status(500).json({ 
            error: '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º.' 
        });
    }
});

// Health check
app.get('/api/health', (req, res) => {
    res.json({ status: 'ok', timestamp: new Date() });
});

// –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
app.listen(PORT, () => {
    console.log(`AI Chat API running on port ${PORT}`);
});
```

### 4.2 Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª `backend/Dockerfile`:

```dockerfile
FROM node:18-alpine

WORKDIR /app

# –ö–æ–ø–∏—Ä—É–µ–º package.json
COPY package*.json ./

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN npm ci --only=production

# –ö–æ–ø–∏—Ä—É–µ–º –∫–æ–¥
COPY . .

# –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
CMD ["node", "server.js"]

EXPOSE 3000
```

### 4.3 Docker Compose –¥–ª—è –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞

–§–∞–π–ª `docker-compose.yml`:

```yaml
version: '3.8'

services:
  ollama:
    image: ollama/ollama:latest
    volumes:
      - ollama_data:/root/.ollama
    ports:
      - "11434:11434"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    
  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data
    ports:
      - "6379:6379"
  
  api:
    build: ./backend
    depends_on:
      - ollama
      - redis
    environment:
      - REDIS_URL=redis://redis:6379
      - OLLAMA_URL=http://ollama:11434
    ports:
      - "3000:3000"
    volumes:
      - ./data:/app/data
  
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./frontend:/usr/share/nginx/html
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - api

volumes:
  ollama_data:
  redis_data:
```

---

## üöÄ –≠–¢–ê–ü 5: DEPLOYMENT

### 5.1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker
curl -fsSL https://get.docker.com | sh

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker Compose
sudo apt install docker-compose -y

# –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
sudo usermod -aG docker $USER

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Nginx (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º Docker)
sudo apt install nginx -y
```

### 5.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

–§–∞–π–ª `nginx.conf`:

```nginx
server {
    listen 80;
    server_name avtogost77.ru;
    
    # –°—Ç–∞—Ç–∏–∫–∞
    location / {
        root /var/www/avtogost77.ru;
        try_files $uri $uri/ /index.html;
    }
    
    # API –ø—Ä–æ–∫—Å–∏
    location /api/ {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        
        # CORS
        add_header 'Access-Control-Allow-Origin' '*';
        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
        add_header 'Access-Control-Allow-Headers' 'Content-Type';
    }
    
    # WebSocket –¥–ª—è real-time —á–∞—Ç–∞
    location /ws {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

### 5.3 Systemd —Å–µ—Ä–≤–∏—Å

–§–∞–π–ª `/etc/systemd/system/avtogost-ai.service`:

```ini
[Unit]
Description=AvtoGOST AI Assistant
After=network.target

[Service]
Type=simple
User=www-data
WorkingDirectory=/var/www/avtogost-ai
ExecStart=/usr/bin/docker-compose up
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

### 5.4 –î–µ–ø–ª–æ–π —Å–∫—Ä–∏–ø—Ç

–§–∞–π–ª `scripts/deploy.sh`:

```bash
#!/bin/bash

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

echo -e "${GREEN}üöÄ –ù–∞—á–∏–Ω–∞–µ–º –¥–µ–ø–ª–æ–π AI Assistant...${NC}"

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
echo "–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã..."
docker-compose down

# –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–¥
echo "–û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–¥ –∏–∑ Git..."
git pull origin main

# –°–æ–±–∏—Ä–∞–µ–º –Ω–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã
echo "–°–æ–±–∏—Ä–∞–µ–º Docker –æ–±—Ä–∞–∑—ã..."
docker-compose build

# –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
echo "–ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã..."
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
sleep 5
if curl -f http://localhost:3000/api/health > /dev/null 2>&1; then
    echo -e "${GREEN}‚úÖ AI Assistant —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω!${NC}"
else
    echo -e "${RED}‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏.${NC}"
    docker-compose logs
    exit 1
fi

echo -e "${GREEN}üéâ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à—ë–Ω!${NC}"
```

---

## üìä –≠–¢–ê–ü 6: –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –£–õ–£–ß–®–ï–ù–ò–ï

### 6.1 –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

–§–∞–π–ª `backend/analytics.js`:

```javascript
const fs = require('fs');
const path = require('path');

class ChatAnalytics {
    constructor() {
        this.logFile = path.join(__dirname, '../logs/chat-analytics.log');
    }
    
    logInteraction(data) {
        const entry = {
            timestamp: new Date().toISOString(),
            ...data
        };
        
        fs.appendFileSync(this.logFile, JSON.stringify(entry) + '\n');
    }
    
    async generateReport() {
        // –ß–∏—Ç–∞–µ–º –ª–æ–≥–∏
        const logs = fs.readFileSync(this.logFile, 'utf-8')
            .split('\n')
            .filter(line => line)
            .map(line => JSON.parse(line));
        
        // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º
        const report = {
            totalInteractions: logs.length,
            uniqueUsers: new Set(logs.map(l => l.userId)).size,
            popularQuestions: this.getPopularQuestions(logs),
            averageResponseTime: this.getAverageResponseTime(logs),
            satisfactionRate: this.getSatisfactionRate(logs)
        };
        
        return report;
    }
    
    getPopularQuestions(logs) {
        const questions = {};
        logs.forEach(log => {
            const q = log.userMessage.toLowerCase();
            questions[q] = (questions[q] || 0) + 1;
        });
        
        return Object.entries(questions)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 10);
    }
    
    getAverageResponseTime(logs) {
        const times = logs.map(l => l.responseTime).filter(t => t);
        return times.reduce((a, b) => a + b, 0) / times.length;
    }
    
    getSatisfactionRate(logs) {
        const satisfied = logs.filter(l => l.feedback === 'positive').length;
        return (satisfied / logs.length) * 100;
    }
}

module.exports = ChatAnalytics;
```

### 6.2 A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –ø—Ä–æ–º–ø—Ç—ã
const experiments = {
    'model-test': {
        variants: ['llama2', 'mistral', 'vicuna'],
        allocation: [0.33, 0.33, 0.34]
    },
    'prompt-style': {
        variants: ['formal', 'friendly', 'casual'],
        allocation: [0.25, 0.50, 0.25]
    }
};

function selectVariant(experimentName, userId) {
    const experiment = experiments[experimentName];
    const hash = simpleHash(userId + experimentName);
    const random = hash / 0xFFFFFFFF;
    
    let cumulative = 0;
    for (let i = 0; i < experiment.variants.length; i++) {
        cumulative += experiment.allocation[i];
        if (random < cumulative) {
            return experiment.variants[i];
        }
    }
    
    return experiment.variants[0];
}
```

### 6.3 Continuous Learning

```python
# scripts/improve_model.py
import json
from datetime import datetime, timedelta

def analyze_failed_interactions():
    """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–µ—É–¥–∞—á–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –º–æ–¥–µ–ª–∏"""
    
    with open('../logs/chat-analytics.log', 'r') as f:
        logs = [json.loads(line) for line in f if line.strip()]
    
    # –ù–∞—Ö–æ–¥–∏–º –≤–æ–ø—Ä–æ—Å—ã –±–µ–∑ –æ—Ç–≤–µ—Ç–∞
    failed = []
    for log in logs:
        if '–Ω–µ –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å' in log.get('aiResponse', '').lower() or \
           '—Å–≤—è–∂–∏—Ç–µ—Å—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º' in log.get('aiResponse', '').lower():
            failed.append({
                'question': log['userMessage'],
                'timestamp': log['timestamp']
            })
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ—Ö–æ–∂–∏–µ –≤–æ–ø—Ä–æ—Å—ã
    grouped = group_similar_questions(failed)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    recommendations = []
    for group in grouped:
        if len(group) > 3:  # –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —á–∞—Å—Ç–æ
            recommendations.append({
                'question_pattern': group[0]['question'],
                'frequency': len(group),
                'recommendation': '–î–æ–±–∞–≤–∏—Ç—å –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π'
            })
    
    return recommendations

def update_knowledge_base(new_entries):
    """–û–±–Ω–æ–≤–ª—è–µ–º –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –Ω–æ–≤—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏"""
    
    with open('../data/company-knowledge.json', 'r') as f:
        knowledge = json.load(f)
    
    # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ FAQ
    for entry in new_entries:
        knowledge['faq'].append({
            'question': entry['question'],
            'answer': entry['answer'],
            'added_date': datetime.now().isoformat(),
            'added_by': 'auto-improvement'
        })
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º
    with open('../data/company-knowledge.json', 'w') as f:
        json.dump(knowledge, f, ensure_ascii=False, indent=2)
    
    print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(new_entries)} –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π")

if __name__ == "__main__":
    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é
    recommendations = analyze_failed_interactions()
    print(f"–ù–∞–π–¥–µ–Ω–æ {len(recommendations)} —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è")
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º –æ—á–µ–≤–∏–¥–Ω—ã–µ —Å–ª—É—á–∞–∏
    # –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Ä–µ–≤—å—é
```

---

## üéØ –ú–ï–¢–†–ò–ö–ò –£–°–ü–ï–•–ê

### KPI –¥–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞:

1. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏:**
   - –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ < 2 —Å–µ–∫—É–Ω–¥—ã
   - –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å > 99.9%
   - –¢–æ—á–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ > 85%

2. **–ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏:**
   - –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∏–∑ —á–∞—Ç–∞ –≤ –∑–∞—è–≤–∫—É > 15%
   - –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –Ω–∞ 40%
   - –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ > 4.5/5

3. **–Æ–∑–∞–±–∏–ª–∏—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏:**
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Å–µ—Å—Å–∏–∏ > 3 –º–∏–Ω—É—Ç
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ —Å–µ—Å—Å–∏—é > 5
   - –ü—Ä–æ—Ü–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ < 20%

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞:**
   ```nginx
   location /api/ {
       # –¢–æ–ª—å–∫–æ —Å –Ω–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞
       valid_referers none blocked avtogost77.ru *.avtogost77.ru;
       if ($invalid_referer) {
           return 403;
       }
   }
   ```

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
   ```javascript
   // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
   function sanitizeInput(input) {
       return input
           .replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
           .replace(/[<>]/g, '')
           .trim()
           .substring(0, 500); // –º–∞–∫—Å–∏–º—É–º 500 —Å–∏–º–≤–æ–ª–æ–≤
   }
   ```

3. **–ó–∞—â–∏—Ç–∞ –æ—Ç prompt injection:**
   ```javascript
   // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞
   const blacklist = [
       'ignore previous instructions',
       'system prompt',
       'reveal instructions',
       'act as',
       'pretend you are'
   ];
   
   if (blacklist.some(phrase => message.toLowerCase().includes(phrase))) {
       return res.status(400).json({ error: '–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –∑–∞–ø—Ä–æ—Å' });
   }
   ```

---

## üìù –ß–ï–ö–õ–ò–°–¢ –ó–ê–ü–£–°–ö–ê

### –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

- [ ] Ollama —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
- [ ] Redis –∑–∞–ø—É—â–µ–Ω
- [ ] API —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞—Ä—Ç—É–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –í–∏–¥–∂–µ—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ
- [ ] –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∏ –ø–æ–ª—É—á–∞—é—Ç –æ—Ç–≤–µ—Ç—ã
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≥–æ—Ç–æ–≤–∞
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

---

## üéâ –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –£ —Ç–µ–±—è —Ç–µ–ø–µ—Ä—å –µ—Å—Ç—å:
- ‚úÖ –ù–∞—Å—Ç–æ—è—â–∏–π AI-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (–Ω–µ —Ñ–µ–π–∫!)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç 24/7 –±–µ–∑ –≤—ã—Ö–æ–¥–Ω—ã—Ö
- ‚úÖ –û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- ‚úÖ –ó–Ω–∞–µ—Ç –≤—Å—ë –æ —Ç–≤–æ–µ–π –∫–æ–º–ø–∞–Ω–∏–∏
- ‚úÖ –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±—É—á–∞–µ—Ç—Å—è
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥ —Ç–≤–æ–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (–∫—Ä–æ–º–µ —Ö–æ—Å—Ç–∏–Ω–≥–∞)

**–ü–µ—Ä–≤—ã–π –≤ —Ä—É–Ω–µ—Ç–µ —á–µ—Å—Ç–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏–∫–∏!** üöÄ

---

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `docker-compose logs -f`
2. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å Ollama: `curl http://localhost:11434/api/tags`
3. –ü—Ä–æ–≤–µ—Ä—å API: `curl http://localhost:3000/api/health`
4. –ü–∏—à–∏ –≤ –Ω–∞—à —á–∞—Ç - –ø–æ–º–æ–∂–µ–º! üòä

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω —Å –ª—é–±–æ–≤—å—é –∫ AI –∏ –ª–æ–≥–∏—Å—Ç–∏–∫–µ. –ü–æ–∫–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã –ø–ª–∞—Ç—è—Ç –∑–∞ ChatGPT API, —Ç—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å —Å–≤–æ–µ–≥–æ AI –±–µ—Å–ø–ª–∞—Ç–Ω–æ!* üí™